function TilesLayer(){var f="";var b="";var d=0;var a="";var c="";Tile=function(k,g,j,m,i,h,o,l){this.id=k;this.isLoading=false;this.Left=j;this.Top=m;this.Url=g;this.placeX=i;this.placeY=h;this.width=o;this.height=o;this.image=l;this.deferred=null;this.draw=function n(p){var q=this;var r=this.image;r.onload=function(){this.onload=null;if(q.deferred.state()!="rejected"){q.deferred.resolve()}};r.onerror=function(){this.src=urlMapF+"/images/spacer.gif";q.deferred.reject()};return q.deferred.promise()}};var e=new Array();this.setUrls=function(h,g){f=h;b=g};this.setMapFolder=function(g,h){a=g;c=h};this.clearLayer=function(){e.length=0};this.clearTile=function(g,h){e[h].deferred.reject()};this.addTile=function(n,g,k,j,m,i,h,o){var l=new Image();l.src=g;e[k]=new Tile("belgis_img"+k,g,j,m,i,h,o,l);e[k].deferred=new $.Deferred();e[k].draw(n).done(function(){n.drawImage(e[k].image,j,m)})};this.replaceTile=function(n,g,i,h,k,m,l,o,j){if(e[i].image.src!=g&&e[i].deferred.state()=="pending"){e[i].deferred.reject()}e[i].Left=h;e[i].Top=k;e[i].placeX=m;e[i].placeY=l;if(e[i].image.src==g&&e[i].deferred.state()=="resolved"){if(j!="endMoveTiles"){n.drawImage(e[i].image,h,k)}}else{e[i].image.src=g;e[i].deferred=new $.Deferred();e[i].draw(n).done(function(){n.drawImage(e[i].image,h,k)})}};this.moveAllTiles=function(g,i,h){e.forEach(function(l,k,j){if(l.deferred.state()=="resolved"){g.drawImage(l.image,l.Left+i,l.Top+h)}})};this.deleteTile=function(g){e.splice[g]};this.getTileDeferred=function(g){return e[g].deferred};this.getTileId=function(g){return e[g].id};this.getTileLeft=function(g){return e[g].Left};this.getTileTop=function(g){return e[g].Top};this.getTilePlaceX=function(g){return e[g].placeX};this.getTilePlaceY=function(g){return e[g].placeY};this.getMinX=function(l,k,g){var j=-1;var h=k;for(var i=1;i<=g;i++){if((e[i].Left+l)<h){h=e[i].Left+l;j=i}}return Array(j,h)};this.getMaxX=function(l,k,g){var j=-1;var i=k;for(var h=1;h<=g;h++){if((e[h].Left+l)>i){i=e[h].Left+l;j=h}}return Array(j,i)};this.getMinY=function(n,m,k,g){var l=-1;var i=m;for(var j=0;j<k;j++){var h=j*g+1;if((e[h].Top+n)<i){i=e[h].Top+n;l=h}}return Array(l,i)};this.getMaxY=function(n,m,k,g){var l=-1;var j=m;for(var i=0;i<k;i++){var h=i*g+1;if((e[h].Top+n)>j){j=e[h].Top+n;l=h}}return Array(l,j)}};